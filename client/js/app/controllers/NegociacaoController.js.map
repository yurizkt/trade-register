{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","Bind","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","_ordenAtual","_service","NegociacaoService","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texto","erro","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","importa","apaga","esvazia","Negociacao","DateHelper","textoParaData","value","parseInt","parseFloat","focus","coluna","_ordemAtual","inverteOrdem","ordena","a","b"],"mappings":";;;;;;IAAMA,oB;AAEL,iCAAa;AAAA;;AAEZ,MAAIC,IAAIC,SAASC,aAAT,CAAuBC,IAAvB,CAA4BF,QAA5B,CAAR;;AAEA,OAAKG,UAAL,GAAkBJ,EAAE,OAAF,CAAlB;AACA,OAAKK,gBAAL,GAAwBL,EAAE,aAAF,CAAxB;AACA,OAAKM,WAAL,GAAmBN,EAAE,QAAF,CAAnB;;AAEA,OAAKO,iBAAL,GAAyB,IAAIC,IAAJ,CACxB,IAAIC,gBAAJ,EADwB,EAExB,IAAIC,eAAJ,CAAoBV,EAAE,kBAAF,CAApB,CAFwB,EAGxB,UAHwB,EAGZ,SAHY,EAGD,QAHC,EAGS,cAHT,CAAzB;;AAMM,OAAKW,SAAL,GAAiB,IAAIH,IAAJ,CAChB,IAAII,QAAJ,EADgB,EAEhB,IAAIC,YAAJ,CAAiBb,EAAE,eAAF,CAAjB,CAFgB,EAGhB,OAHgB,CAAjB;;AAMA,OAAKc,WAAL,GAAmB,EAAnB;;AAEA,OAAKC,QAAL,GAAgB,IAAIC,iBAAJ,EAAhB;;AAEA,OAAKC,KAAL;AACN;;;;0BAEM;AAAA;;AAEN,QAAKF,QAAL,CACEG,KADF,GAEEC,IAFF,CAEO;AAAA,WACLC,YAAYC,OAAZ,CAAoB;AAAA,YACnB,MAAKd,iBAAL,CAAuBe,QAAvB,CAAgCC,UAAhC,CADmB;AAAA,KAApB,CADK;AAAA,IAFP,EAKKC,KALL,CAKW;AAAA,WAAQ,MAAKb,SAAL,CAAec,KAAf,GAAuBC,IAA/B;AAAA,IALX;;AAOGC,eAAY,YAAM;AACjB,UAAKC,kBAAL;AACA,IAFD,EAEG,IAFH;AAIH;;;2BAEQC,K,EAAM;AAAA;;AACdA,SAAMC,cAAN;;AAEA,OAAIP,aAAa,KAAKQ,eAAL,EAAjB;;AAEA,QAAKhB,QAAL,CACEiB,QADF,CACWT,UADX,EAEEJ,IAFF,CAEO,oBAAY;AACjB,WAAKZ,iBAAL,CAAuBe,QAAvB,CAAgCC,UAAhC;AACA,WAAKZ,SAAL,CAAec,KAAf,GAAuBQ,QAAvB;AACA,WAAKC,gBAAL;AACA,IANF,EAOEV,KAPF,CAOQ;AAAA,WAAQ,OAAKb,SAAL,CAAec,KAAf,GAAuBC,IAA/B;AAAA,IAPR;AAQA;;;uCAEmB;AAAA;;AAEnB,QAAKX,QAAL,CACEoB,OADF,CACU,KAAK5B,iBAAL,CAAuBa,WADjC,EAEED,IAFF,CAEO;AAAA,WAAeC,YAAYC,OAAZ,CAAoB,sBAAc;AACtD,YAAKd,iBAAL,CAAuBe,QAAvB,CAAgCC,UAAhC;AACA,YAAKZ,SAAL,CAAec,KAAf,GAAuB,mCAAvB;AACA,KAHoB,CAAf;AAAA,IAFP,EAMED,KANF,CAMQ;AAAA,WAAQ,OAAKb,SAAL,CAAec,KAAf,GAAuBC,IAA/B;AAAA,IANR;AAOA;;;0BAEM;AAAA;;AAEN,QAAKX,QAAL,CACEqB,KADF,GAEEjB,IAFF,CAEO,oBAAY;AACjB,WAAKR,SAAL,CAAec,KAAf,GAAuBQ,QAAvB;AACA,WAAK1B,iBAAL,CAAuB8B,OAAvB;AACA,IALF,EAMEb,KANF,CAMQ;AAAA,WAAQ,OAAKb,SAAL,CAAec,KAAf,GAAuBC,IAA/B;AAAA,IANR;AAOA;;;oCAEgB;AAChB,UAAO,IAAIY,UAAJ,CACNC,WAAWC,aAAX,CAAyB,KAAKpC,UAAL,CAAgBqC,KAAzC,CADM,EAENC,SAAS,KAAKrC,gBAAL,CAAsBoC,KAA/B,CAFM,EAGNE,WAAW,KAAKrC,WAAL,CAAiBmC,KAA5B,CAHM,CAAP;AAIA;;;qCAEiB;AACjB,QAAKrC,UAAL,CAAgBqC,KAAhB,GAAwB,EAAxB;AACA,QAAKpC,gBAAL,CAAsBoC,KAAtB,GAA8B,CAA9B;AACA,QAAKnC,WAAL,CAAiBmC,KAAjB,GAAyB,GAAzB;AACA,QAAKrC,UAAL,CAAgBwC,KAAhB;AACA;;;yBAEMC,M,EAAO;;AAEb,OAAG,KAAKC,WAAL,IAAoBD,MAAvB,EAA8B;AAC7B,SAAKtC,iBAAL,CAAuBwC,YAAvB;AACA,IAFD,MAEM;AACL,SAAKxC,iBAAL,CAAuByC,MAAvB,CAA8B,UAACC,CAAD,EAAIC,CAAJ;AAAA,YAAUD,EAAEJ,MAAF,IAAYK,EAAEL,MAAF,CAAtB;AAAA,KAA9B;AACA;AACD,QAAKC,WAAL,GAAmBD,MAAnB;AACA","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController {\n\n\tconstructor(){\n\n\t\tlet $ = document.querySelector.bind(document)\n\n\t\tthis._inputData = $('#data')\n\t\tthis._inputQuantidade = $('#quantidade')\n\t\tthis._inputValor = $('#valor')\n\n\t\tthis._listaNegociacoes = new Bind(\n\t\t\tnew ListaNegociacoes(), \n\t\t\tnew NegociacoesView($('#negociacoesView')), \n\t\t\t'adiciona', 'esvazia', 'ordena', 'inverteOrdem'\n\t\t)\n\n        this._mensagem = new Bind(\n        \tnew Mensagem(), \n        \tnew MensagemView($('#mensagemView')), \n        \t'texto'\n        )\n\n        this._ordenAtual = ''\n\n        this._service = new NegociacaoService()\n\n        this._init()\n\t}\n\n\t_init(){\n\n\t\tthis._service\n\t\t\t.lista()\n\t\t\t.then(negociacoes => \n\t\t\t\tnegociacoes.forEach(negociacao => \n\t\t\t\t\tthis._listaNegociacoes.adiciona(negociacao)))\n\t    \t.catch(erro => this._mensagem.texto = erro)\n\n\t    setInterval(() => {\n\t    \tthis.importaNegociacoes()\n\t    }, 3000)\n\t\t\n\t}\n\n\tadiciona(event){\n\t\tevent.preventDefault()\n\n\t\tlet negociacao = this._criaNegociacao()\n\n\t\tthis._service\n\t\t\t.cadastra(negociacao)\n\t\t\t.then(mensagem => {\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao)\n\t\t\t\tthis._mensagem.texto = mensagem\n\t\t\t\tthis._limpaFormulario()\n\t\t\t})\n\t\t\t.catch(erro => this._mensagem.texto = erro)\n\t}\n\n\timportaNegociacoes(){\n\n\t\tthis._service\n\t\t\t.importa(this._listaNegociacoes.negociacoes)\n\t\t\t.then(negociacoes => negociacoes.forEach(negociacao => {\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao)\n\t\t\t\tthis._mensagem.texto = 'Negociação importadas com sucesso'\n\t\t\t}))\n\t\t\t.catch(erro => this._mensagem.texto = erro)\n\t}\n\n\tapaga(){\n\n\t\tthis._service\n\t\t\t.apaga()\n\t\t\t.then(mensagem => {\n\t\t\t\tthis._mensagem.texto = mensagem\n\t\t\t\tthis._listaNegociacoes.esvazia()\n\t\t\t})\n\t\t\t.catch(erro => this._mensagem.texto = erro)\n\t}\n\n\t_criaNegociacao(){\n\t\treturn new Negociacao(\n\t\t\tDateHelper.textoParaData(this._inputData.value),\n\t\t\tparseInt(this._inputQuantidade.value),\n\t\t\tparseFloat(this._inputValor.value))\n\t}\n\n\t_limpaFormulario(){\n\t\tthis._inputData.value = ''\n\t\tthis._inputQuantidade.value = 1\n\t\tthis._inputValor.value = 0.0\n\t\tthis._inputData.focus()\n\t}\n\n\tordena(coluna){\n\n\t\tif(this._ordemAtual == coluna){\n\t\t\tthis._listaNegociacoes.inverteOrdem()\n\t\t} else{\n\t\t\tthis._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna])\n\t\t}\n\t\tthis._ordemAtual = coluna\n\t}\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"]}