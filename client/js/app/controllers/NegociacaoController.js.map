{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["Mensagem","Negociacao","ListaNegociacoes","NegociacoesView","MensagemView","NegociacaoService","DateHelper","Bind","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","_mensagem","_ordenAtual","_service","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texto","erro","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","importa","apaga","esvazia","textoParaData","value","parseInt","parseFloat","focus","coluna","_ordemAtual","inverteOrdem","ordena","a","b"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import {Mensagem} from '../models/Mensagem';\nimport {Negociacao} from '../models/Negociacao';\nimport {ListaNegociacoes} from '../models/ListaNegociacoes';\nimport {NegociacoesView} from '../views/NegociacoesView';\nimport {MensagemView} from '../views/MensagemView';\nimport {NegociacaoService} from '../services/NegociacaoService';\nimport {DateHelper} from '../helpers/DateHelper';\nimport {Bind} from '../helpers/Bind';\n\nexport class NegociacaoController {\n\n\tconstructor(){\n\n\t\tlet $ = document.querySelector.bind(document)\n\n\t\tthis._inputData = $('#data')\n\t\tthis._inputQuantidade = $('#quantidade')\n\t\tthis._inputValor = $('#valor')\n\n\t\tthis._listaNegociacoes = new Bind(\n\t\t\tnew ListaNegociacoes(), \n\t\t\tnew NegociacoesView($('#negociacoesView')), \n\t\t\t'adiciona', 'esvazia', 'ordena', 'inverteOrdem'\n\t\t)\n\n        this._mensagem = new Bind(\n        \tnew Mensagem(), \n        \tnew MensagemView($('#mensagemView')), \n        \t'texto'\n        )\n\n        this._ordenAtual = ''\n\n        this._service = new NegociacaoService()\n\n        this._init()\n\t}\n\n\t_init(){\n\n\t\tthis._service\n\t\t\t.lista()\n\t\t\t.then(negociacoes => \n\t\t\t\tnegociacoes.forEach(negociacao => \n\t\t\t\t\tthis._listaNegociacoes.adiciona(negociacao)))\n\t    \t.catch(erro => this._mensagem.texto = erro)\n\n\t    setInterval(() => {\n\t    \tthis.importaNegociacoes()\n\t    }, 3000)\n\t\t\n\t}\n\n\tadiciona(event){\n\t\tevent.preventDefault()\n\n\t\tlet negociacao = this._criaNegociacao()\n\n\t\tthis._service\n\t\t\t.cadastra(negociacao)\n\t\t\t.then(mensagem => {\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao)\n\t\t\t\tthis._mensagem.texto = mensagem\n\t\t\t\tthis._limpaFormulario()\n\t\t\t})\n\t\t\t.catch(erro => this._mensagem.texto = erro)\n\t}\n\n\timportaNegociacoes(){\n\n\t\tthis._service\n\t\t\t.importa(this._listaNegociacoes.negociacoes)\n\t\t\t.then(negociacoes => negociacoes.forEach(negociacao => {\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao)\n\t\t\t\tthis._mensagem.texto = 'Negociação importadas com sucesso'\n\t\t\t}))\n\t\t\t.catch(erro => this._mensagem.texto = erro)\n\t}\n\n\tapaga(){\n\n\t\tthis._service\n\t\t\t.apaga()\n\t\t\t.then(mensagem => {\n\t\t\t\tthis._mensagem.texto = mensagem\n\t\t\t\tthis._listaNegociacoes.esvazia()\n\t\t\t})\n\t\t\t.catch(erro => this._mensagem.texto = erro)\n\t}\n\n\t_criaNegociacao(){\n\t\treturn new Negociacao(\n\t\t\tDateHelper.textoParaData(this._inputData.value),\n\t\t\tparseInt(this._inputQuantidade.value),\n\t\t\tparseFloat(this._inputValor.value))\n\t}\n\n\t_limpaFormulario(){\n\t\tthis._inputData.value = ''\n\t\tthis._inputQuantidade.value = 1\n\t\tthis._inputValor.value = 0.0\n\t\tthis._inputData.focus()\n\t}\n\n\tordena(coluna){\n\n\t\tif(this._ordemAtual == coluna){\n\t\t\tthis._listaNegociacoes.inverteOrdem()\n\t\t} else{\n\t\t\tthis._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna])\n\t\t}\n\t\tthis._ordemAtual = coluna\n\t}\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"]}